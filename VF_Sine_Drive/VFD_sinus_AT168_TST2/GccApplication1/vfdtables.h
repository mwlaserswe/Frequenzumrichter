 /*  Variable Frequency Drive with AVR ATMega 88/168/328    */
/*! \file *********************************************************************
 *
 *
 *      This file contains the table definitions used for sine control.
 *
 * \par Based on Application note:
 *      AVR447: Sinusoidal driving of three-phase permanent motor using
 *      ATmega48/88/168
 *
 * \par Documentation
 *      For comprehensive code documentation, supported compilers, compiler
 *      settings and supported devices see readme.html
 *
 * \author
 *      Atmel Corporation: http://www.atmel.com \n
 *      Support email: avr@atmel.com
 * 	by Matthias Schoeldgen - DC7UR 
 * $Name: RELEASE_1_0 $
 * $Revision: 1.4 $
 * $RCSfile: PMSMtables.h,v $
 * $Date: 2010/04/16 11:57:20 $  \n
 ******************************************************************************/

#define PURE_SINE_DRIVE 1

#ifndef _PMSM_TABLES_H_
#define _PMSM_TABLES_H_

#ifdef PURE_SINE_DRIVE
const PROGMEM uint8_t sineTable[SINE_TABLE_LENGTH * 3] = {
128,  17,  238,    
132,  15,  236,    
136,  13,  234,    
140,  11,  231,    
144,  10,  229,    
148,  8,   226,    
152,  7,   223,    
156,  5,   221,    
160,  4,   218,    
165,  3,   215,    
168,  2,   212,    
172,  2,   208,    
176,  1,   205,    
180,  1,   202,    
184,  0,   198,    
188,  0,   195,    
191,  0,   191,    
195,  0,   188,    
198,  0,   184,    
202,  1,   180,    
205,  1,   176,    
208,  2,   172,    
212,  2,   168,    
215,  3,   165,    
218,  4,   160,    
221,  5,   156,    
223,  7,   152,    
226,  8,   148,    
229,  10,  144,    
231,  11,  140,    
234,  13,  136,    
236,  15,  132,    
238,  17,  128,    
240,  19,  123,    
242,  21,  119,    
244,  24,  115,    
245,  26,  111,    
247,  29,  107,    
248,  32,  103,    
250,  34,  99,     
251,  37,  95,     
252,  40,  90,     
253,  43,  87,     
253,  47,  83,     
254,  50,  79,     
254,  53,  75,     
255,  57,  71,     
255,  60,  67,     
255,  64,  64,     
255,  67,  60,     
255,  71,  57,     
254,  75,  53,     
254,  79,  50,     
253,  83,  47,     
253,  87,  43,     
252,  90,  40,     
251,  95,  37,     
250,  99,  34,     
248, 103,  32,     
247, 107,  29,     
245, 111,  26,     
244, 115,  24,     
242, 119,  21,     
240, 123,  19,                     // 
238, 128,  17, 					//
236, 132,  15,     
234, 136,  13,     
231, 140,  11,     
229, 144,  10,     
226, 148,  8,      
223, 152,  7,      
221, 156,  5,      
218, 160,  4,      
215, 165,  3,      
212, 168,  2,      
208, 172,  2,      
205, 176,  1,      
202, 180,  1,      
198, 184,  0,      
195, 188,  0,      
191, 191,  0,      
188, 195,  0,      
184, 198,  0,      
180, 202,  1,      
176, 205,  1,      
172, 208,  2,      
168, 212,  2,      
165, 215,  3,      
160, 218,  4,      
156, 221,  5,      
152, 223,  7,      
148, 226,  8,      
144, 229,  10,     
140, 231,  11,     
136, 234,  13,     
132, 236,  15,     
128, 238,  17,     
123, 240,  19,     
119, 242,  21,     
115, 244,  24,     
111, 245,  26,     
107, 247,  29,     
103, 248,  32,     
99,  250,  34,     
95,  251,  37,     
90,  252,  40,     
87,  253,  43,     
83,  253,  47,     
79,  254,  50,     
75,  254,  53,     
71,  255,  57,     
67,  255,  60,     
64,  255,  64,     
60,  255,  67,     
57,  255,  71,     
53,  254,  75,     
50,  254,  79,     
47,  253,  83,     
43,  253,  87,     
40,  252,  90,     
37,  251,  95,     
34,  250,  99,     
32,  248,  103,    
29,  247,  107,    
26,  245,  111,    
24,  244,  115,    
21,  242,  119,    
19,  240,  123,    
17,  238,  128,                              // 
15,  236,  132,     
13,  234,  136,     
11,  231,  140,     
10,  229,  144,     
8,   226,  148,     
7,   223,  152,     
5,   221,  156,     
4,   218,  160,     
3,   215,  165,     
2,   212,  168,     
2,   208,  172,     
1,   205,  176,     
1,   202,  180,     
0,   198,  184,     
0,   195,  188,     
0,   191,  191,     
0,   188,  195,     
0,   184,  198,     
1,   180,  202,     
1,   176,  205,     
2,   172,  208,     
2,   168,  212,     
3,   165,  215,     
4,   160,  218,     
5,   156,  221,     
7,   152,  223,     
8,   148,  226,     
10,  144,  229,     
11,  140,  231,     
13,  136,  234,     
15,  132,  236,     
17,  128,  238,     
19,  123,  240,     
21,  119,  242,     
24,  115,  244,     
26,  111,  245,     
29,  107,  247,     
32,  103,  248,     
34,  99,   250,     
37,  95,   251,     
40,  90,   252,     
43,  87,   253,     
47,  83,   253,     
50,  79,   254,     
53,  75,   254,     
57,  71,   255,     
60,  67,   255,     
64,  64,   255,     
67,  60,   255,     
71,  57,   255,     
75,  53,   254,     
79,  50,   254,     
83,  47,   253,     
87,  43,   253,     
90,  40,   252,     
95,  37,   251,     
99,  34,   250,     
103, 32,   248,     
107, 29,   247,     
111, 26,   245,     
115, 24,   244,     
119, 21,   242,     
123, 19,   240      
};    
#else 
/*!   \brief Sine wave modulation table
 *    
 *    Table containing modulation values for all three phases.
 *    The table is organized as [U1,  V1, W1, U2, V2, W2, ...]
 *    for forward driving, and [U1, W1, V1, U2, W2, V2, ...]
 *    for reverse driving.
 */         
const PROGMEM uint8_t sineTable[SINE_TABLE_LENGTH * 3] = {
0,       0,      221,		// Offset 0 
8,       0,      225,
17,      0,      229,
25,      0,      232,
33,      0,      236,
42,      0,      239,
50,      0,      241,
58,      0,      244,
66,      0,      246,
74,      0,      248,
82,      0,      250,
90,      0,      252,
98,      0,      253,
105,     0,      254,
113,     0,      254,
120,     0,      255,		
128,     0,      255,		// 0x10
135,     0,      255,
142,     0,      254,
149,     0,      254,
155,     0,      253,
162,     0,      252,
168,     0,      250,
174,     0,      248,
180,     0,      246,
186,     0,      244,
192,     0,      241,
197,     0,      239,
202,     0,      236,
207,     0,      232,
212,     0,      229,
217,     0,      225,
221,     0,      221,		// 0x20
225,     0,      217,
229,     0,      212,
232,     0,      207,
236,     0,      202,
239,     0,      197,
241,     0,      192,
244,     0,      186,
246,     0,      180,
248,     0,      174,
250,     0,      168,
252,     0,      162,
253,     0,      155,
254,     0,      149,
254,     0,      142,
255,     0,      135,
255,     0,      127,		// 0x30
255,     0,      120,
254,     0,      113,
254,     0,      105,
253,     0,      98,
252,     0,      90,
250,     0,      82,
248,     0,      74,
246,     0,      66,
244,     0,      58,
241,     0,      50,
239,     0,      42,
236,     0,      33,
232,     0,      25,
229,     0,      17,
225,     0,      8,
221,     0,      0,		// 0x40
225,     8,      0,
229,     17,     0,
232,     25,     0,
236,     33,     0,
239,     42,     0,
241,     50,     0,
244,     58,     0,
246,     66,     0,
248,     74,     0,
250,     82,     0,
252,     90,     0,
253,     98,     0,
254,     105,    0,
254,     113,    0,
255,     120,    0,
255,     127,    0,		// 0x50
255,     135,    0,
254,     142,    0,
254,     149,    0,
253,     155,    0,
252,     162,    0,
250,     168,    0,
248,     174,    0,
246,     180,    0,
244,     186,    0,
241,     192,    0,
239,     197,    0,
236,     202,    0,
232,     207,    0,
229,     212,    0,
225,     217,    0,
221,     221,    0,		// 0x60
217,     225,    0,
212,     229,    0,
207,     232,    0,
202,     236,    0,
197,     239,    0,
192,     241,    0,
186,     244,    0,
180,     246,    0,
174,     248,    0,
168,     250,    0,
162,     252,    0,
155,     253,    0,
149,     254,    0,
142,     254,    0,
135,     255,    0,
128,     255,    0,		//0x70
120,     255,    0,
113,     254,    0,
105,     254,    0,
98,      253,    0,
90,      252,    0,
82,      250,    0,
74,      248,    0,
66,      246,    0,
58,      244,    0,
50,      241,    0,
42,      239,    0,
33,      236,    0,
25,      232,    0,
17,      229,    0,
8,       225,    0,
0,       221,    0,		// 0x80
0,       225,    8,
0,       229,    17,
0,       232,    25,
0,       236,    33,
0,       239,    42,
0,       241,    50,
0,       244,    58,
0,       246,    66,
0,       248,    74,
0,       250,    82,
0,       252,    90,
0,       253,    98,
0,       254,    105,
0,       254,    113,
0,       255,    120,
0,       255,    128,		// 0x90
0,       255,    135,
0,       254,    142,
0,       254,    149,
0,       253,    155,
0,       252,    162,
0,       250,    168,
0,       248,    174,
0,       246,    180,
0,       244,    186,
0,       241,    192,
0,       239,    197,
0,       236,    202,
0,       232,    207,
0,       229,    212,
0,       225,    217,
0,       221,    221,		// 0xa0
0,       217,    225,
0,       212,    229,
0,       207,    232,
0,       202,    236,
0,       197,    239,
0,       192,    241,
0,       186,    244,
0,       180,    246,
0,       174,    248,
0,       168,    250,
0,       162,    252,
0,       155,    253,
0,       149,    254,
0,       142,    254,
0,       135,    255,
0,       128,    255,		// 0xb0
0,       120,    255,
0,       113,    254,
0,       105,    254,
0,       98,     253,
0,       90,     252,
0,       82,     250,
0,       74,     248,
0,       66,     246,
0,       58,     244,
0,       50,     241,
0,       42,     239,
0,       33,     236,
0,       25,     232,
0,       17,     229,
0,       8,      225		// 0xbf
};
#endif
// provide compatibility with GCC definitions
// sometimes needed, sometimes not. Lets disable them here until we want them
/*
#define PB0 0
#define PB1 1
#define PB2 2
#define PB3 3
#define PB4 4
#define PB5 5
#define PB6 6
#define PB7 7

#define PC0 0
#define PC1 1
#define PC2 2

#define PD0 0
#define PD1 1
#define PD2 2
#define PD3 3
#define PD4 4
#define PD5 5
#define PD6 6
#define PD7 7
*/
// PHASES to pins

#define VH PB1
#define VL PB2
#define WH PB3

#define WL PD3
#define UL PD5
#define UH PD6




#endif
